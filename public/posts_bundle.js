(()=>{"use strict";function t(t){return`https://hansungpocs.site/${t}`}const e=document.querySelector("#notice table thead"),o=document.querySelector("#notice table tbody"),n=15;let a,c=1,s="",i=localStorage.getItem("sessionToken"),d=new Headers({"x-pocs-session-token":i});const r=localStorage.getItem("userType");function l(){let t='<ul class="pagination justify-content-center">\n                <li class="page-item">\n                    <a class="page-link" href="#" tabindex="-1" aria-disabled="true" onclick="movePreviousPage()">Previous</a>\n                </li>',e=5*Math.ceil(c/5);e>a&&(e=a);for(let o=e-4<=0?1:e-4;o<=e;o++)t+=`<li class="page-item ${c==o?"active":""}"><a class="page-link" onclick="movePage(${o})">${o}</a></li>`;t+='<li class="page-item">\n                    <a class="page-link" href="#" onclick="moveNextPage()">Next</a>\n                </li>',document.querySelector("#post-pagination-bar").innerHTML=t}async function u(n,a,c,i){await g(n),await async function(t){fetch(t,{headers:d}).then((t=>t.json())).then((n=>{if(console.log(n),console.log(t),function(t){const e=document.querySelector(".category #study_count"),o=document.querySelector(".category #memory_count"),n=document.querySelector(".category #reference_count"),a=document.querySelector(".category #knowhow_count");t.map((t=>{switch(t.category){case"스터디":e.innerHTML=`(${t.count})`;break;case"추억":o.innerHTML=`(${t.count})`;break;case"노하우":a.innerHTML=`(${t.count})`;break;case"추천":n.innerHTML=`(${t.count})`}}))}(n.data.categories),function(t){if(null==t||""==t)return;let e=t.split("=")[1];const o=document.querySelectorAll(".category .list-group-item"),n=document.querySelector(`.category #${e}`);for(let t=0;t<o.length;t++)o[t].style.backgroundColor="white";n.style.backgroundColor="lightblue"}(s),e.innerHTML='<tr class="post-list">\n        <th>번호</th>\n        <th>제목</th>\n        <th>작성자</th>\n        <th>작성일</th>\n        <th>카테고리</th>\n    </tr>',o.innerHTML="",null===n.data)o.innerHTML="<tr><td>0</td><td>글을 작성하세요.</td><td></td></tr>";else for(let t=0;t<n.data.posts.length;t++)n.data.posts[t].onlyMember&&"anonymous"===r?o.innerHTML+=`<tr class="post-list">\n                        <td>${n.data.posts[t].postId}</td>\n                        <td>비공개</td>\n                        <td></td>\n                        <td></td>\n                        <td></td>\n                        </tr>`:o.innerHTML+=`\n                        <tr class="post-list">\n                        <td>${n.data.posts[t].postId}</td>\n                        <td onclick="checktoGoDetailPage(${n.data.posts[t].postId})"\n                            >${n.data.posts[t].title}</td>\n                        <td >${n.data.posts[t].writerName||"익명"}</td>\n                        <td>${n.data.posts[t].createdAt}</td>\n                        <td>${n.data.posts[t].category}</td>\n                        </tr>\n                        `}))}(t(`api/posts?${a}&offset=${c}&pageNum=${i}`)),l()}async function g(e){await fetch(t(`api/posts?${s}&offset=15&pageNum=${c}`),{headers:d}).then((t=>t.json())).then((t=>{a="study"===e?Math.ceil(t.data.categories[0].count/15):"memory"===e?Math.ceil(t.data.categories[2].count/15):"reference"===e?Math.ceil(t.data.categories[3].count/15):"knowhow"===e?Math.ceil(t.data.categories[4].count/15):Math.ceil((t.data.categories[0].count+t.data.categories[1].count+t.data.categories[2].count+t.data.categories[3].count+t.data.categories[4].count)/15)})).catch((t=>console.log(t)))}window.backToPostList=function(){window.location.href="./posts.html"},window.movePostAddPage=function(){window.location.href="./posts_add.html"},window.clickCategory=async function(t){"anonymous"===localStorage.getItem("userType")&&"study"!==t?alert("비회원은 스터디 글만 볼수 있습니다."):(s=`id=${t}`,c=1,u(t,s,n,c))},window.checktoGoDetailPage=function(t){window.location.href=`posts_detail.html?postId=${t}`},window.movePage=async function(t){t>a||c!==t&&(c=t,u(s.split("id=")[1],s,n,c))},window.movePreviousPage=async function(){c<=1||(c--,u(s.split("id=")[1],s,n,c))},window.moveNextPage=async function(){c>=a||(c++,u(s.split("id=")[1],s,n,c))},async function(){const t=window.location.href.split("?category=");let e;e=t.length<2?"undefined":t[1],"undefined"===e||"undefined#"===e?(s="",u("",s,n,c)):(s=`id=${e}`,u(e,s,n,c))}(),function(){const t=document.getElementById("post-add-button");"anonymous"===localStorage.getItem("userType")&&t.classList.add("hidden")}()})();