(()=>{document.querySelector("#notice table");const t=document.querySelector("#notice table thead"),e=document.querySelector("#notice table tbody");let o,n=1,a="",c=`http://34.64.170.244:80/api/posts?${a}&offset=15&pageNum=${n}`,s=localStorage.getItem("sessionToken"),i=new Headers({"x-pocs-session-token":s});const l=localStorage.getItem("userType");function d(){fetch(c,{headers:i}).then((t=>t.json())).then((o=>{if(console.log(o),console.log(c),function(t){const e=document.querySelector(".category #study_count"),o=document.querySelector(".category #memory_count"),n=document.querySelector(".category #reference_count"),a=document.querySelector(".category #knowhow_count");e.innerHTML=`(${t[0].count})`,o.innerHTML=`(${t[2].count})`,n.innerHTML=`(${t[3].count})`,a.innerHTML=`(${t[4].count})`}(o.data.categories),function(t){if(null==t||""==t)return;let e=t.split("=")[1];const o=document.querySelectorAll(".category .list-group-item"),n=document.querySelector(`.category #${e}`);for(let t=0;t<o.length;t++)o[t].style.backgroundColor="white";n.style.backgroundColor="lightblue"}(a),t.innerHTML='<tr class="post-list">\n        <th>번호</th>\n        <th>제목</th>\n        <th>작성자</th>\n        <th>작성일</th>\n        <th>카테고리</th>\n    </tr>',e.innerHTML="",null===o.data)e.innerHTML="<tr><td>0</td><td>글을 작성하세요.</td><td></td></tr>";else for(let t=0;t<o.data.posts.length;t++)o.data.posts[t].onlyMember&&"anonymous"===l?e.innerHTML+=`<tr class="post-list">\n                        <td>${o.data.posts[t].postId}</td>\n                        <td>비공개</td>\n                        <td></td>\n                        <td></td>\n                        <td></td>\n                        </tr>`:e.innerHTML+=`\n                        <tr class="post-list">\n                        <td>${o.data.posts[t].postId}</td>\n                        <td onclick="checktoGoDetailPage(${o.data.posts[t].postId})"\n                            >${o.data.posts[t].title}</td>\n                        <td >${o.data.posts[t].writerName||"익명"}</td>\n                        <td>${o.data.posts[t].createdAt}</td>\n                        <td>${o.data.posts[t].category}</td>\n                        </tr>\n                        `}))}function r(){let t='<ul class="pagination justify-content-center">\n                <li class="page-item">\n                    <a class="page-link" href="#" tabindex="-1" aria-disabled="true" onclick="movePreviousPage()">Previous</a>\n                </li>',e=5*Math.ceil(n/5);e>o&&(e=o);for(let o=e-4<=0?1:e-4;o<=e;o++)t+=`<li class="page-item ${n==o?"active":""}"><a class="page-link" onclick="movePage(${o})">${o}</a></li>`;t+='<li class="page-item">\n                    <a class="page-link" href="#" onclick="moveNextPage()">Next</a>\n                </li>',document.querySelector("#post-pagination-bar").innerHTML=t}async function u(t){await fetch(c,{headers:i}).then((t=>t.json())).then((e=>{o="study"===t?Math.ceil(e.data.categories[0].count/15):"memory"===t?Math.ceil(e.data.categories[2].count/15):"reference"===t?Math.ceil(e.data.categories[3].count/15):"knowhow"===t?Math.ceil(e.data.categories[4].count/15):"qna"===t?Math.ceil(e.data.categories[5].count/15):Math.ceil((e.data.categories[0].count+e.data.categories[1].count+e.data.categories[2].count+e.data.categories[3].count+e.data.categories[4].count+e.data.categories[5].count)/15)})),console.log(o)}window.backToPostList=function(){window.location.href="../html/posts.html"},window.movePostAddPage=function(){window.location.href="../html/posts_add.html"},window.clickCategory=async function(t){"anonymous"===localStorage.getItem("userType")&&"study"!==t?alert("비회원은 스터디 글만 볼수 있습니다."):(a=`id=${t}`,n=1,c=`http://34.64.170.244:80/api/posts?${a}&offset=15&pageNum=${n}`,await u(t),await d(),await r())},window.checktoGoDetailPage=function(t){window.location.href=`posts_detail.html?postId=${t}`},async function(){const t=window.location.href.split("?category=");let e;e=t.length<2?"undefined":t[1],"undefined"===e||"undefined#"===e?(a="",c=`http://34.64.170.244:80/api/posts?${a}&offset=15&pageNum=${n}`,await u(""),await d(),await r()):(a=`id=${e}`,c=`http://34.64.170.244:80/api/posts?${a}&offset=15&pageNum=${n}`,await u(e),await d(),await r())}(),function(){const t=document.getElementById("post-add-button");"anonymous"===localStorage.getItem("userType")&&t.classList.add("hidden")}()})();