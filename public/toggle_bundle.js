(()=>{const n=document.getElementById("toggle"),e=localStorage.getItem("sessionToken"),t=document.getElementById("toggleDetail"),l=(document.getElementById("navItem"),document.getElementById("adminBtn")),a=localStorage.getItem("userId"),i=document.querySelector(".navbar .container .nav-item a img");let o=localStorage.getItem("userType");const s=document.querySelector(".nav-item img");async function d(n){const e={method:"POST",headers:{"Content-Type":"application/json","x-pocs-session-token":n}},t=await fetch("http://34.64.170.244:80/api/auth/validation",e),l=await t.json();return console.log(l),200===l.status?(console.log(l.data.user),"anonymous"!=l.data.user.type&&(null!=l.data.user.defaultInfo.userProfilePath?s.src=`http://34.64.170.244${l.data.user.defaultInfo.userProfilePath}`:s.src="../img/logo.png"),l.data.user):(console.log(l.message),!1)}function c(n){t.innerHTML="loginFirst"===n?'<li><a class="dropdown-item" href="../html/index.html">로그인</a></li>':"anonymous"===o?'\n            <li><a class="dropdown-item" href="#" onclick="handleLogout()">로그아웃</a></li>\n        ':`\n            <li><a class="dropdown-item" href="../html/user_detail_edit.html?userId=${n}">내 정보 수정</a></li>\n            <li><a class="dropdown-item" href="#" onclick="handleLogout()">로그아웃</a></li>\n        `}document.body.insertAdjacentHTML='<nav class="navbar navbar-expand-sm bg-light justify-content-center"\n  style="position: sticky; top: 0; height: auto; z-index: 10">\n<div class="container">\n  <div class="navbar-brand nav-link" onclick="moveMainPage()" style="cursor: pointer;">POCS</div>\n  <ul class="navbar-nav" id="navItem">\n      <li class="nav-item" id="NoticeBtn">\n          <div class=\'nav-link\' onclick="moveNoticePage()" style="cursor: pointer;">Notice</div>\n      </li>\n      <li class="nav-item" id="PostBtn">\n          <div class="nav-link" onclick="movePostPage()" style="cursor: pointer;">Post</div>\n      </li>\n      <li class="nav-item" id="UserBtn">\n          <div class="nav-link" onclick="moveUserPage()" style="cursor: pointer;">User</div>\n      </li>\n      <li class="nav-item">\n          <a class="nav-link" href="qa.html">Q/A</a>\n      </li>\n      <li class="nav-item hidden" id="adminBtn">\n          <a class="nav-link" href="admin.html">Admin</a>\n      </li>\n  </ul>\n  <div class="nav-item dropdown">\n      <a class="nav-link dropdown-toggle" href="#" id="toggle" role="button" data-bs-toggle="dropdown">\n          <img src="../img/logo.png" style="width:40px;" class="rounded-pill">\n      </a>\n      <ul class="dropdown-menu"  id="toggleDetail">\n          \n      </ul>\n  </div>\n</div>\n</nav>',window.location.href.includes("index")||null===e&&(window.location.href="../html/index.html"),window.location.href.includes("index")||(window.addEventListener("load",(async function(){if(null!=e){let n=await d(e);"admin"===n.type&&(l.classList.toggle("hidden"),null!=window.location.href.match("notices.html")?document.getElementById("noticeAddBtn").classList.toggle("hidden"):null!=window.location.href.match("notices_detail.html")&&document.getElementById("noticeEditBtn").classList.toggle("hidden")),null!=window.location.href.match("main")?"admin"!==n.type&&"member"!==n.type||document.getElementById("userList").classList.toggle("hidden"):null==window.location.href.match("qa_add")&&null==window.location.href.match("qa_detail_edit")||"anonymous"==n.type||document.getElementById("title-below-area").classList.toggle("hidden"),null!=n.defaultInfo.userProfilePath&&(i.src=`http://34.64.161.55:80${n.defaultInfo.userProfilePath}`)}})),n.addEventListener("click",(async function(t){if(t.preventDefault(),n.classList.contains("show"))if(null!=e){let n=await d(e);null!=n.userId?c(n.userId):console.log("유효하지 않은 토큰입니다.")}else c("loginFirst")})),window.addEventListener("storage",(()=>{alert("userId값은 변경될수 없습니다!"),localStorage.removeItem("userId"),localStorage.setItem("userId",a)})))})();